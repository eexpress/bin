---
title: 64位系统运行32位游戏
date: 2017-12-19 06:18:41
tags:
- game
- i686
---

> 背景：鉴于烦人的新版本升级提醒，以及手动升级无效的情况，我在F26的系统上，使用u盘全新升级到了F27。
一些喜爱的老游戏，又不能运行了。我向来喜欢最干净的安装，所以手动修复游戏的一切错误提示。

## 64位系统运行32位游戏
> 修复的关键游戏，就是很老的etqw和较老的SteamWorld Heist。2种截然不同的风格的游戏。

### 启动故障部分

> (Wayland 和 X11 下)启动时，无反应。命令行可见提示 `No such file or directory`，使用 `ldd` 检测时提示 `not a dynamic executable`。

1. 首先安装 glibc.i686，可解决此2种提示。
1. 然后 ldd 才会正常提示缺少的库。
1. 使用 whatprovides 查找并安装缺失的相应的 i686 包。
libopenal.so.1
```
▶ ldd Heist|grep found
	libopenal.so.1 => not found
	libGL.so.1 => not found
	libstdc++.so.6 => not found
	libgcc_s.so.1 => not found

▶ dnf whatprovides libopenal.so.1 libGL.so.1 libstdc++.so.6 libgcc_s.so.1
上次元数据过期检查：1:56:21 前，执行于 2017年12月18日 星期一 22时34分30秒。
openal-soft-1.18.0-3.fc27.i686 : Open Audio Library
仓库        ：fedora
匹配来源：
Provide    : libopenal.so.1

libglvnd-glx-1:1.0.0-1.fc27.i686 : GLX support for libglvnd
仓库        ：updates
匹配来源：
Provide    : libGL.so.1

libglvnd-glx-1:0.2.999-24.20170818git8d4d03f.fc27.i686 : GLX support for libglvnd
仓库        ：fedora
匹配来源：
Provide    : libGL.so.1

libstdc++-7.2.1-2.fc27.i686 : GNU Standard C++ Library
仓库        ：fedora
匹配来源：
Provide    : libstdc++.so.6

libgcc-7.2.1-2.fc27.i686 : GCC version 7 shared support library
仓库        ：fedora
匹配来源：
Provide    : libgcc_s.so.1

▶ di openal-soft-1.18.0-3.fc27.i686 ......
```

### 实时运行故障
> 游戏运行后，无画面，卡死，以及无声音。Heist 画面不显示，切换到tty3下，kill掉进程才能在tty1看到提示。

1. libGL error： (unable|failed).*

		libGL error: unable to load driver: i965_dri.so
		libGL error: driver pointer missing
		libGL error: failed to load driver: i965
		libGL error: unable to load driver: i965_dri.so
		libGL error: driver pointer missing
		libGL error: failed to load driver: i965
		libGL error: unable to load driver: swrast_dri.so
		libGL error: failed to load driver: swrast
	> 安装 xorg-x11-drv-intel.i686 mesa-dri-drivers.i686 的包

1. AL lib

		AL lib: (WW) pulse_load: Failed to load libpulse.so.0
		AL lib: (WW) alc_initconfig: Failed to initialize backend "pulse"
		AL lib: (WW) alsa_load: Failed to load libasound.so.2
		AL lib: (WW) alc_initconfig: Failed to initialize backend "alsa"
		AL lib: (EE) ALCplaybackOSS_open: Could not open /dev/dsp: No such file or directory
		AL lib: (WW) alcSetError: Error generated on device (nil), code 0xa004
	> 安装pulseaudio-libs-11.1-7.fc27.i686 alsa-lib-1.1.5-1.fc27.i686(dnf whatprovides查找所需的包) alsa-plugins-pulseaudio.i686(etqw的无dsp的错误) 的包，以解决 pulse/alsa/dsp 方面的错误提示。


1. 图像不显示的问题。只能看到非关键的提示 `libpng warning: iCCP: known incorrect sRGB profile`。

	> 悲惨的无法解决，只好安装 wine，才可以正常显示 Heist 的画面。草。

	> 先记录下这次新增的包列表，我有时间会找到所需要的库的。

		已安装:
		  wine.x86_64 2.20-1.fc27
		  sane-backends-drivers-cameras.i686 1.0.27-7.fc27
		  sane-backends-drivers-scanners.i686 1.0.27-7.fc27
		  avahi-libs.i686 0.7-3.fc27
		  bzip2-libs.i686 1.0.6-24.fc27
		  cairo.i686 1.15.8-1.fc27
		  cdparanoia-libs.i686 10.2-24.fc27
		  cups-libs.i686 1:2.2.4-6.fc27
		  cyrus-sasl-lib.i686 2.1.26-34.fc27
		  fontconfig.i686 2.12.6-4.fc27
		  freetype.i686 2.8-6.fc27
		  gd.i686 2.2.5-1.fc27
		  glib2.i686 2.54.2-1.fc27
		  gmp.i686 1:6.1.2-6.fc27
		  gnutls.i686 3.5.16-4.fc27
		  graphite2.i686 1.3.10-3.fc27
		  gstreamer1.i686 1.12.4-1.fc27
		  gstreamer1-plugins-base.i686 1.12.4-1.fc27
		  harfbuzz.i686 1.4.8-1.fc27
		  isdn4k-utils.i686 3.27-8.fc27
		  isdn4k-utils.x86_64 3.27-8.fc27
		  isdn4k-utils-data.noarch 3.27-8.fc27
		  jbigkit-libs.i686 2.1-8.fc27
		  keyutils-libs.i686 1.5.10-3.fc27
		  krb5-libs.i686 1.15.2-4.fc27
		  lcms2.i686 2.8-5.fc27
		  libXcomposite.i686 0.4.4-11.fc27
		  libXcursor.i686 1.1.14-10.fc27
		  libXft.i686 2.3.2-7.fc27
		  libXinerama.i686 1.1.3-9.fc27
		  libXpm.i686 3.5.12-4.fc27
		  libXrandr.i686 1.5.1-4.fc27
		  libXrender.i686 0.9.10-4.fc27
		  libblkid.i686 2.30.2-1.fc27
		  libcom_err.i686 1.43.5-2.fc27
		  libcrypt-nss.i686 2.26-16.fc27
		  libdatrie.i686 0.2.9-6.fc27
		  libdb.i686 5.3.28-26.fc27
		  liberation-narrow-fonts.noarch 1:1.07.4-9.fc27
		  libexif.i686 0.6.21-13.fc27
		  libglvnd-egl.i686 1:1.0.0-1.fc27
		  libgphoto2.i686 2.5.16-1.fc27
		  libidn2.i686 2.0.4-1.fc27
		  libieee1284.i686 0.2.11-23.fc27
		  libmount.i686 2.30.2-1.fc27
		  libpcap.i686 14:1.8.1-6.fc27
		  libtasn1.i686 4.12-3.fc27
		  libthai.i686 0.1.25-4.fc27
		  libtheora.i686 1:1.1.1-18.fc27
		  libtiff.i686 4.0.9-1.fc27
		  libtool-ltdl.i686 2.4.6-20.fc27
		  libunistring.i686 0.9.7-3.fc27
		  libusbx.i686 1.0.21-4.fc27
		  libv4l.i686 1.12.5-5.fc27
		  libva.i686 1.8.3-3.fc27
		  libverto.i686 0.2.6-11.fc27
		  libvisual.i686 1:0.4.0-23.fc27
		  libwayland-client.i686 1.14.0-1.fc27
		  libwayland-server.i686 1.14.0-1.fc27
		  libwebp.i686 0.6.1-1.fc27
		  libxml2.i686 2.9.5-2.fc27
		  lockdev.i686 1.0.4-0.25.20111007git.fc27
		  mesa-libEGL.i686 17.2.4-2.fc27
		  mesa-libOSMesa.i686 17.2.4-2.fc27
		  mesa-libOSMesa.x86_64 17.2.4-2.fc27
		  mesa-libgbm.i686 17.2.4-2.fc27
		  mingw32-wine-gecko.noarch 2.47-2.fc26
		  mingw64-wine-gecko.noarch 2.47-2.fc26
		  mpg123-libs.i686 1.25.6-1.fc27
		  nettle.i686 3.4-1.fc27
		  nspr.i686 4.17.0-1.fc27
		  nss.i686 3.34.0-1.0.fc27
		  nss-mdns.i686 0.10-20.fc27
		  nss-pem.i686 1.0.3-6.fc27
		  nss-softokn.i686 3.34.0-1.0.fc27
		  nss-softokn-freebl.i686 3.34.0-1.0.fc27
		  nss-util.i686 3.34.0-1.0.fc27
		  ocl-icd.i686 2.2.11-4.fc27
		  openldap.i686 2.4.45-4.fc27
		  openssl-libs.i686 1:1.1.0g-1.fc27
		  opus.i686 1.2.1-3.fc27
		  orc.i686 0.4.27-3.fc27
		  p11-kit.i686 0.23.9-2.fc27
		  pango.i686 1.40.14-1.fc27
		  pcre.i686 8.41-3.fc27
		  readline.i686 7.0-7.fc27
		  samba-common-tools.x86_64 2:4.7.3-3.fc27
		  samba-winbind.x86_64 2:4.7.3-3.fc27
		  samba-winbind-clients.x86_64 2:4.7.3-3.fc27
		  samba-winbind-modules.x86_64 2:4.7.3-3.fc27
		  sane-backends-libs.i686 1.0.27-7.fc27
		  sqlite-libs.i686 3.20.1-1.fc27
		  unixODBC.i686 2.3.4-7.fc27
		  unixODBC.x86_64 2.3.4-7.fc27
		  wine-alsa.i686 2.20-1.fc27
		  wine-alsa.x86_64 2.20-1.fc27
		  wine-arial-fonts.noarch 2.20-1.fc27
		  wine-capi.i686 2.20-1.fc27
		  wine-capi.x86_64 2.20-1.fc27
		  wine-cms.i686 2.20-1.fc27
		  wine-cms.x86_64 2.20-1.fc27
		  wine-common.noarch 2.20-1.fc27
		  wine-core.i686 2.20-1.fc27
		  wine-core.x86_64 2.20-1.fc27
		  wine-courier-fonts.noarch 2.20-1.fc27
		  wine-desktop.noarch 2.20-1.fc27
		  wine-filesystem.noarch 2.20-1.fc27
		  wine-fixedsys-fonts.noarch 2.20-1.fc27
		  wine-fonts.noarch 2.20-1.fc27
		  wine-ldap.i686 2.20-1.fc27
		  wine-ldap.x86_64 2.20-1.fc27
		  wine-marlett-fonts.noarch 2.20-1.fc27
		  wine-mono.noarch 4.7.1-1.fc27
		  wine-ms-sans-serif-fonts.noarch 2.20-1.fc27
		  wine-openal.i686 2.20-1.fc27
		  wine-openal.x86_64 2.20-1.fc27
		  wine-opencl.i686 2.20-1.fc27
		  wine-opencl.x86_64 2.20-1.fc27
		  wine-pulseaudio.i686 2.20-1.fc27
		  wine-pulseaudio.x86_64 2.20-1.fc27
		  wine-small-fonts.noarch 2.20-1.fc27
		  wine-symbol-fonts.noarch 2.20-1.fc27
		  wine-system-fonts.noarch 2.20-1.fc27
		  wine-systemd.noarch 2.20-1.fc27
		  wine-tahoma-fonts.noarch 2.20-1.fc27
		  wine-times-new-roman-fonts.noarch 2.20-1.fc27
		  wine-twain.i686 2.20-1.fc27
		  wine-twain.x86_64 2.20-1.fc27
		  wine-wingdings-fonts.noarch 2.20-1.fc27

		完毕！

	> 升级了一次，dr wine移除了一堆软件后，测试Heist居然正常显示了，只是光标似乎有黑边，估计是不支持png透明的渲染。
